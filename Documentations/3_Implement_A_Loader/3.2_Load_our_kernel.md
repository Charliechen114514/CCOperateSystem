# 加载我们的内核

​	现在，我们可以进一步迈向我们的内核了。那就是加载我们的内核。刚刚我们说过，加载我们的内核之前需要做的就是配置好我们的GPT表，开启A20地址分线和开启保护模式，在之后，我们就需要确定我们的内存大小，布置我们的页表以及将内核加载进入我们的内存。从而进入我们的操作系统当中去。本篇的任务亦如此。

## 如何检测内存

​	BIOS存在一个方法，那就是使用BIOS 0x15号中断完成对内存的检测。说起来，就是分为三个部分：

- 办法1：使用系统功能号0xE820办法，遍历主机板上所有可以被识别的内存，这样我们就可以获取主机上所有的内存大小了
- 办法2：使用功能号0xE801，分别检测两次内存。第一次检测的是低15MB的内存，第二次才会检测16MB~4GB的内存。这个方法就是极限检测4GB的内存
- 办法3：使用AH为0x88的办法，最大只可以返回64MB内存。

​	笔者看到大部分人的实现都是0xE820办法失败后，就直接进入卡死通知内存检测失败了。笔者这里打算致敬一下《操作系统真相还原》，三个方法都进行尝试。

### 使用0xE820办法获取所有的内存

​	0xE820办法是最好的，它会返回我们内存信息的详细布局。